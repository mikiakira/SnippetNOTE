$(function(e){var h;var f;var d;var g;var b;getLabelList();getArticlelList(1);var i=$("[data-remodal-id=modal]").remodal();var a=$("[data-remodal-id=labelEdit]").remodal();function c(){i.open();setTimeout(function(){i.close()},3000)}$("#headerMenuGroup").on("click","#addLabel",function(){var j=prompt("ラベル名を入力して下さい","");if(j===""){}else{exePost("label","add","0",j,"","","").done(function(k){getLabelList()}).fail(function(k){c()})}});$("#headerMenuGroup").on("click","#editLabel",function(){$("#labelId").val($("#labels").val());$("#labelTitle").val($("#labels option:selected").html());a.open()});$("#labelEditButtonArea").on("click","#deleteLabel",function(){if(window.confirm("このラベルを削除すると関連する記事も削除されます。よろしいですか？")){var j=$("#labelId").val();exePost("label","del",j,"","","","").done(function(){getLabelList();a.close()}).fail(function(){c()})}});$("#labelEditButtonArea").on("click","#editLabel",function(){var k=$("#labelId").val();var j=$("#labelTitle").val();exePost("label","edit",k,j,"","","").done(function(){getLabelList();a.close()}).fail(function(){c()})});$(document).on("change","#labels",function(){getArticlelList($(this).val())});$(document).on("click","#addArticle",function(){resetForm()});$(document).on("click","#editArticle",function(){h=$("#label").val();d=$("#mode").val();var j=ace.edit("article");f=j.getValue();b=$("#editArticleId").val();g=$("#title").val();exePost("article","add",b,h,g,f,d).done(function(k){}).fail(function(k){c()})});$(document).on("click",".viewArticle",function(j){$("#editArticleId").val($(this).data("article"));b=$(this).data("article");exePost("article","find",b,"","","","").done(function(m){var l=$.parseJSON(m);$("#editArticleId").val(l.id);$("#title").val(l.title);$("#label").val(l.labelid);$("#mode").val(l.mode);var k=ace.edit("article");k.getSession().setValue(l.article);setSyntaxMode(l.mode)}).fail(function(k){c()})});$(document).on("click","#editArticle",function(){h=$("#label").val();d=$("#mode").val();var j=ace.edit("article");f=j.getValue();b=$("#editArticleId").val();g=$("#title").val();exePost("article","edit",b,h,g,f,d).done(function(k){getArticlelList(h)}).fail(function(k){c()})});$(document).on("click","#delete",function(){b=$("#editArticleId").val();h=$("#label").val();exePost("article","del",b,"","","").done(function(j){resetForm();getArticlelList(h)}).fail(function(j){c()})});$(document).on("click","#copy",function(){var j=ace.edit("article");copyTextToClipboard(j.getValue())});$("#buttonArea").on("change","#mode",function(){setSyntaxMode($(this).val())})});function exePost(f,c,g,b,e,d,a){return $.ajax({type:"POST",url:"pdo.php",dataType:"text",timeout:10000,data:{mode:f,action:c,id:g,label:b,title:e,article:d,a_mode:a}})}function getLabelList(){exePost("label","list","all","","","").done(function(b){$("#labels .listCategory").remove();$("select#label option").remove();var c=$.parseJSON(b);var a="";$.each(c,function(d,e){a+="<option value='"+e.id+"'>"+e.name+"</option>"});$("#labels").html(a);$("#label").html(a)}).fail(function(a){alert("system Error")})}function getArticlelList(a){$("#articles").html("");exePost("article","list","",a,"","").done(function(c){var d=$.parseJSON(c);var b="";$.each(d,function(e,f){b+="<li class='list-group-item viewArticle' data-article='"+f.id+"'>"+f.title+"</li>"});$("#articles").html(b)}).fail(function(b){alert("system Error")})}function resetForm(){$("#label").val("");$("#title").val("");var a=ace.edit("article");a.getSession().setValue("");$("#editArticleId").val("0")}function copyTextToClipboard(a){var d=document.createElement("textarea");d.textContent=a;var b=document.getElementsByTagName("body")[0];b.appendChild(d);d.select();var c=document.execCommand("copy");b.removeChild(d);return c}function setSyntaxMode(a){if((a!="")||(a!=null)){editor.getSession().setMode("ace/mode/"+a)}};